# 📊 Excel智能分析工具 - 完整版

一个基于AI的Excel数据分析工具，提供自然语言查询、智能数据洞察、交互式可视化和高级统计分析功能。

## 🌟 功能特色

### 🤖 AI智能分析
- **自然语言数据查询** - 用中文提问，AI自动分析数据
- **智能数据洞察生成** - 自动发现数据中的关键信息
- **AI驱动的图表建议** - 根据数据特征推荐最佳图表类型
- **自动异常值检测** - 智能识别数据中的异常点
- **多模型支持** - 支持OpenAI、Claude、通义千问等多种AI模型

### 📊 数据可视化
- **8种图表类型** - 柱状图、折线图、散点图、饼图、箱线图、热力图、直方图、小提琴图
- **交互式图表操作** - 缩放、筛选、悬停显示详细信息
- **自定义样式设置** - 颜色、主题、标题等个性化配置
- **AI图表解读** - 自动生成图表分析报告

### 🧹 数据处理
- **智能数据清洗** - 自动处理缺失值、重复值、数据类型转换
- **多种统计分析** - 描述性统计、相关性分析、分组统计
- **假设检验工具** - t检验、卡方检验等统计检验方法
- **回归分析功能** - 线性回归、多元回归分析

### 🎯 示例数据
- **销售数据生成器** - 生成包含季节性和趋势的销售数据
- **员工数据生成器** - 生成符合实际情况的员工信息数据

## 🚀 快速开始

### 方法一：一键启动（推荐）
```bash
python start_full.py
```

### 方法二：手动启动
1. 安装依赖：
```bash
pip install -r requirements_full.txt
```

2. 启动应用：
```bash
streamlit run app_full.py --server.port 8502
```

3. 打开浏览器访问：http://localhost:8502

## ⚙️ 系统要求

- **Python版本**: 3.8+
- **操作系统**: Windows/macOS/Linux
- **内存**: 建议4GB以上
- **网络**: 需要网络连接以使用AI功能

## 📦 依赖项

### 核心依赖
- `streamlit` - Web应用框架
- `pandas` - 数据处理
- `plotly` - 交互式图表
- `openpyxl` - Excel文件处理

### AI功能依赖
- `langchain` - AI应用开发框架
- `openai` - OpenAI API客户端
- `langchain-openai` - LangChain OpenAI集成

### 分析功能依赖
- `scikit-learn` - 机器学习
- `scipy` - 科学计算
- `numpy` - 数值计算

## 🔧 配置说明

### AI模型配置

应用支持多种AI模型，可在侧边栏进行配置：

#### 内置模型选项
1. **OpenAI GPT-4**
   - 模型: `gpt-4`
   - 基础URL: `https://api.openai.com/v1`

2. **OpenAI GPT-3.5**
   - 模型: `gpt-3.5-turbo`
   - 基础URL: `https://api.openai.com/v1`

3. **通义千问**
   - 模型: `qwen-plus`
   - 基础URL: `https://dashscope.aliyuncs.com/compatible-mode/v1`

4. **DeepSeek**
   - 模型: `deepseek-chat`
   - 基础URL: `https://api.deepseek.com/v1`

5. **自定义配置**
   - 支持用户自定义API密钥、模型名称和基础URL

### 环境变量配置（可选）

创建 `.env` 文件：
```env
# OpenAI配置
OPENAI_API_KEY=your_openai_api_key
OPENAI_BASE_URL=https://api.openai.com/v1

# 通义千问配置
DASHSCOPE_API_KEY=your_dashscope_api_key

# DeepSeek配置
DEEPSEEK_API_KEY=your_deepseek_api_key
```

## 📖 使用指南

### 1. 数据上传
- 支持 `.xlsx` 和 `.xls` 格式
- 自动检测数据类型和编码
- 显示数据预览和基本信息

### 2. AI智能分析
- 在"AI智能分析"页面输入中文问题
- 例如："销售额最高的是哪个月份？"
- AI会自动分析数据并提供答案

### 3. 数据可视化
- 选择图表类型和数据列
- 自定义图表样式和颜色
- 支持图表导出和分享

### 4. 数据清洗
- 自动检测数据质量问题
- 一键处理缺失值和重复值
- 数据类型转换和格式化

### 5. 统计分析
- 描述性统计分析
- 相关性分析和热力图
- 假设检验和回归分析

### 6. 数据筛选
- 多条件数据筛选
- 支持数值范围和文本匹配
- 筛选结果可导出

## 🔍 故障排除

### 常见问题

**Q: 启动时提示依赖项缺失？**
A: 运行 `pip install -r requirements_full.txt` 安装所有依赖项

**Q: AI功能无法使用？**
A: 检查API密钥配置是否正确，确保网络连接正常

**Q: 上传Excel文件失败？**
A: 确保文件格式为 `.xlsx` 或 `.xls`，文件大小不超过200MB

**Q: 图表显示异常？**
A: 尝试刷新页面，检查数据列是否包含有效的数值数据

### 性能优化

1. **大文件处理**
   - 建议单个文件不超过100MB
   - 对于大数据集，考虑先进行数据采样

2. **内存使用**
   - 及时清理不需要的数据
   - 避免同时加载多个大文件

3. **AI响应速度**
   - 选择合适的模型（GPT-3.5响应更快）
   - 简化问题描述以获得更快响应

## 🆚 版本对比

| 功能 | 简易版 | 完整版 |
|------|--------|--------|
| 数据上传 | ✅ | ✅ |
| 基础图表 | ✅ | ✅ |
| 数据清洗 | ✅ | ✅ |
| 统计分析 | ✅ | ✅ |
| AI智能分析 | ❌ | ✅ |
| 自然语言查询 | ❌ | ✅ |
| 多模型支持 | ❌ | ✅ |
| 高级统计 | 基础 | 完整 |
| 示例数据生成 | ❌ | ✅ |

## 🔮 未来计划

- [ ] 支持更多数据格式（CSV、JSON等）
- [ ] 添加更多AI模型支持
- [ ] 实现数据预测功能
- [ ] 支持多表关联分析
- [ ] 添加报告生成功能
- [ ] 支持实时数据连接

## 📞 技术支持

如果您在使用过程中遇到问题，请：

1. 查看本文档的故障排除部分
2. 检查控制台错误信息
3. 确保所有依赖项正确安装
4. 验证API密钥配置

## 📄 许可证

本项目仅供学习和研究使用。

---

**享受智能数据分析的乐趣！** 🎉